---
layout: post
title: Chests
date: '2015-11-25T00:59:00.001-08:00'
author: smelC
tags: 
modified_time: '2015-11-25T01:20:00.068-08:00'
blogger_id: tag:blogger.com,1999:blog-989893979829990763.post-8644788116713722241
blogger_orig_url: https://hgamesdev.blogspot.com/2015/11/chests.html
---

<p>Last week I coded chests and guarding monsters. Chest can only be placed closed to walls, and cannot be walked on (they are treated like racks of weapons). Until a chest has been opened, it is displayed as a yellow ©. Once opened it becomes grey, and if empty its symbol is changed to ‘o’. Initially I wanted to use ♛ and ♕ but they weren’t in <a href="https://github.com/SquidPony/SquidLib">SquidLib</a>’s default font. Then <a href="https://github.com/tommyettinger">tommy</a> added them, but the augmented font looks weird for the moment; so I’ve kept the © and ‘o’ symbols for now and hope to change soon. Here’s a closed chest:</p> <p><img src="http://i.imgur.com/os4A8Ju.png" alt="Closed chest" title=""></p> <p>and the chest after opening it:</p> <p><img src="http://imgur.com/D0HPD34.png" alt="Open chest" title=""></p> <p>Together with chests I’ve coded guarding monsters. Guarding is dynamic: initially monsters do not guard anything and when they get close to something interesting, they’ll start guarding it if there’s no guarding monster yet. To do that, I’ve introduced a <code>IGuardable</code> interface, and elements of the grid can return an instance of this interface if they can be guarded. Then monsters choose if the guardable is worth guarding from their POV. If yes, they’ll start guarding. When guarding, they wander around the stuff being guarded (using the generic code for wandering, but restricted to choose wander targets around the stuff being guarded). If a player comes close to a guarding monster, the monster will attack him but you cannot lurk the monster away, since he’ll go back to guarding if he gets farther away from the thing it guards than the target.</p> <p>I wanted guarding to be dynamic, first because it avoids to initially put monsters close to chests/stuff to guard. And I later want to add necromancers that’ll stay close to corpses, so that they can raise undeads. To do that, I’ll just make corpses return the adequate instances of <code>IGuardable</code> et voila necromancers will lurk in areas filled with corpses automatically :-)</p> <p>So now the AI of monsters has four states: sleeping, wandering (choose a random cell in the map, go there), hunting (chase target), and guarding (wander or hunt close to chest).</p> <p>Next I’ll implement saves (go pimp my <a href="https://github.com/libgdx/libgdx/pull/3592">PR</a> on libgdx that’ll make my save-code smaller!).</p> <blockquote>  <p>Written with <a href="https://stackedit.io/">StackEdit</a>.</p></blockquote>