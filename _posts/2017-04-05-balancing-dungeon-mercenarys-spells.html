---
layout: post
title: Balancing Dungeon Mercenary's spells sytem
date: '2017-04-05T00:52:00.001-07:00'
author: smelC
tags: 
modified_time: '2017-04-05T00:52:50.661-07:00'
blogger_id: tag:blogger.com,1999:blog-989893979829990763.post-5571529635331825160
blogger_orig_url: https://hgamesdev.blogspot.com/2017/04/balancing-dungeon-mercenarys-spells.html
---

<p>Since <a href="http://www.schplaf.org/hgames/">Dungeon Mercenary</a>’s last release, I’ve been working on adding a spell system (which will make it to the next release in June). It was pretty fun to design and to code. Balance of spells is much harder to tune than balance of melee weapons, because spells are more diverse. Here’s the list of spells accessible to the player:</p> <ul><li>Dragon breath: a spell doing as much damage as firebolt, but it’s not a projectile, it covers an area.</li><li>Dragon slaying: a projectile spell that only affects dragons.</li><li>Firebolt: a projectile spell (i.e. affects only its target).</li><li>Force: a spell that pushes something (an enemy, an item, a barrel, you, etc.) by a given number of cells.</li><li>Health: a healing spell.</li><li>Lightning: a beam spell that affects every animated creatures under the beam.</li><li>Orc’n gobs’n trolls slaying: a projectile spell that only affects goblin, orcs, and trolls.</li><li>Paralysis: a projectile spell that paralyses its target for some turns (paralysed targets are automatically hit in melee and take thrice damages).</li><li>Poison: a spell that deals cumulative damages during its duration.</li><li>Protection: a spell that surrounds its target by a protective haze (that’ll absorb later damage)</li><li>Quietus: a spell that instantly kills an enemy.</li><li>Raise skeleton: a spell that raises an ally skeleton from the body of a fallen foo.</li><li>Slowness: a spell that slows down an enemy during its duration.</li><li>Teleportation: a spell that teleports something (an enemy, an item, a barrel, you, etc.) away.</li><li>Undead slaying: a projectile spell that only affects undeads.</li><li>Vampirism: a spell that transfers some of the target’s health to the caster.</li></ul> <p>In Dungeon Mercenary, all items can be <em>boosted</em>. So first I had to define what it means for a spell to be boosted. So I classified the spells in different boost categories:</p> <ul><li>Spells whose <em>damage increases</em> when boosted: dragon breath, firebolt, * slaying, lighthning, vampirism, health (restored health increases for the last two), protection (amount of protective hit points increase)</li><li>Spells whose <em>duration increases</em> when boosted: paralysis, poison (also makes the damages increase therefore), slowness</li><li>Spells whose <em>cooldown decreases</em> (i.e. that can be cast more often) when boosted (because these spells’ effect cannot be changed): quietus, teleportation, raise skeleton</li><li>Force: boosting this spell increases the number of cells by which an object/someone is pushed (because a monster takes damages when pushed against a wall, this increases the spell’s damages).</li></ul> <p>To check the balance of spells, I then generated some stats (using <a href="https://gist.github.com/smelc/876dd75ecb67a1ee8b1df01a11b45f6d">this code</a>) regarding the damages they deal. First I supposed that the number of time you can boost a spell will be equivalent to the current dungeon depth (i.e. when you’re at depth 5, the strongest spell you can have at most a level-5 spell). That’s sensible, since you can roughly find at most one boost runic per level.</p> <p>Then, the crux was that spells look a bit incomparable at first. For example, quietus doesn’t deal a fixed amount of damage, since it instantly kills a creature. So to evaluate its damage, I’ve supposed that the amount of damage it does at a given dungeon depth is the number of hit points of the toughest monster at this level (makes sense since player will use quietus on the toughest monster). I’ve done the same for paralysis, as it stuns a monster for a number of turns, during which any melee hit will do thrice damages (meaning you’ll instanstly kill most monsters).</p> <p>Another incomparable spell is force which pushes monsters back. It can do damage if the pushed monster is blocked by a wall while being pushed, or stopped by another monster (dealing damage to the latter too). So I’ve used the “blocking” amount of damage as force’s damage.</p> <p>Then, spells do not all have the same cooldown (quietus having the biggest cooldown), so I evaluated the number of damages that a spell can do in 1024 turns. Here’s the resulting data which I’ve generated using gnuplot (here’s the <a href="https://gist.github.com/smelc/827529deeac71a357a078a340c936142">script</a>).</p> <p><img src="http://i.imgur.com/g7ZsCat.png" alt="Damages of spell in Dungeon Mercenary" title=""></p> <p>First, let me explain that some spells are missing because they deal the same amount of damages as other spells. For example, all foo slaying spells deal the same damage, so I’ve put only dragon slaying (the spell with the highest line). Then, the health spell is missing too, because it gives back as much health as firebolt deals damage. </p> <p>Let’s analyze the data now!</p> <ul><li>Foo slaying spells deal the most damage. That’s okay since they can only target some monsters</li><li>Poison is the strongest high-level spell. It’s nice since it’s clearly a long term investment (it’s only at boost level 7 that it becomes better than firebolt) and it doesn’t kill in a single turn (for poison to deal its total damage, the target must stay alive as many turns as poison’s level)</li><li>Firebolt and lightning deal almost exactly the same damage. It is intended as it’s the two “base” spells against which the other are adjusted. What’s not shown in the graphic is that lightning deal a variable amount of damages, from 1 to twice firebolt’s damage: the mean is shown in the graphic. So it’s a very variable spell. Sometimes it’ll be destructive, sometimes it’ll do almost nothing. This gives firebolt and lightning a different gameplay feel.</li><li>Force deals a bit less damage than firebolt. It seems okay as it’s a versatile spell that can be used to block paths (by pushing barrels), push items lying on the ground, etc. It also helps to flee in dangerous situations.</li><li>Quietus has a funny curve, as its amount of damage depends on the monsters that have been generated at every depth. Overall it seems okay. Depth 12 introduces a monster with a lot of hit points (trolls), hereby explaining the increase of damage.</li><li>Paralysis is better than quietus initially, because its cooldown is smaller; but quietus become gradually better (see high levels). Overall, they seem equally powerful; which is okay as they have fit different gameplay styles (you need to finish off paralysed monsters in melee).</li><li>Protection seems like the weakest spell, but it’s a spell that stacks. So you can cast protection multiple time (until the amount of protection you have is half your maximum hit points).</li></ul> <p>As the data backing up the script is automatically generated by querying the game’s data, I can change some stats within the game and regenerate the graph to check that the modification has the desired effect. And that concludes how I balanced my spell system. Hope this helps/interests some of you. Spread the roguelike love ❤</p> <blockquote>  <p>Written with <a href="https://stackedit.io/">StackEdit</a>.</p></blockquote>